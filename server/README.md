# README

## 抽奖 

基于ROR的抽奖平台，不会前端TAT, 先把后端写完在慢慢搞前端

### 特色
使用HPB的真随机数作为抽奖的依赖\
创建抽奖活动时取当前的块高，开奖时跟据块高往后推30个块取其上的随机数

### 活动模式

#### 1.普通抽奖
参与即可抽奖，每人一票

#### 2.邀请抽奖
参与即可抽奖，每邀请一人，增加一票

#### 3.大奖盘抽奖
参与即可抽奖, 实时开奖

### 开奖模式
1. 到时开奖
2. 到达人数目标开奖

### 开奖逻辑
取HPB随机数的后8位除以票池里面票数,取余作为中奖的序号,去除中奖者在重复操作，直到所有奖品全部发放完成

#### 票池设计
一个数组， 元素为参与的用户ID, 可重复做为权重
普通抽奖： 按参与抽奖时间正序加入票池
邀请抽奖： 按参与抽奖时间和邀请者加入时间 正序加入票池

例： 
[userID1, userID2, userID1, userID3, userID1, userID4]
 
### list
 -[X] 表设计
 -[X] JWT
 -[X] 创建活动
 -[X] 展示列表
 -[X] 普通活动开奖
 -[X] 邀请活动奖池
 -[ ] 大转盘
 -[ ] 前端TAT
 -[ ] Docker
  

\
...

建库
> rails db:migrate

项目启动
> rails s -p 端口号 -d -b 0.0.0.0

### log
9-17 \
为避免重复助力，由redis的list改为添加一张助力log表

9-25 \
...我先学学前端，暂时停止更新



